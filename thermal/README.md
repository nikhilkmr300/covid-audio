# thermal
This is the sub-directory for the approach using thermal images.

## Directory structure
```
.
├── data
├── models_face
├── models_landmarks
├── results_face
└── results_landmarks
```

The data has not been uploaded.
It has been licensed from Marcin Kopaczka's Thermal Face Project, and is the data referenced in [this](https://ieeexplore.ieee.org/document/8409768) IEEE paper.
The repository [marcinkopaczka/thermalfaceproject](https://github.com/marcinkopaczka/thermalfaceproject)
has instructions on getting a license to access the database.

You can download the data as a zip file after obtaining the license. Move the file to `./data`, and unzip it.

The models used to generate the landmarks require a bounding box around the face.

`models_face`: Contains models used to generate bounding boxes around faces in thermal images.  
`models_landmarks`: Contains models used to detect the landmarks on the faces in thermal images.  
`results_face`: Contains sub-directories for the resultant images generated by each model in `models_face`.  
`results_landmarks`: Contains sub-directories for the resultant images generated by each model in `models_landmarks`.

## Instructions

Follow these instructions after you have access to the data and have moved it to the correct location as detailed above.

To generate the results of a model in `models_face`, run `make` with the target name for that model in `models_face`.
For instance, if you wanted to generate the results of the HOG+SVM model, run `make hog`. (The names of the targets are in the `Makefile`.)
The resultant images will be written to `results_face`.

Similarly, for the landmark models, run `make` with the target name for that model in `models_landmarks`.
The resultant images will be written to `results_landmarks`.

This will also split the data into train, valid and test on the first run.
You can change the seed and split ratio in `data/split_data.py`.
